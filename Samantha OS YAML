services:
  - type: web
    name: samantha-voice-ai
    env: docker
    plan: starter # $7/month - always on, no sleep
    dockerfilePath: ./Dockerfile
    healthCheckPath: /healthz
    
    envVars:
      # N8N Configuration
      - key: N8N_PORT
        value: 5678
      
      - key: N8N_PROTOCOL
        value: https
      
      - key: N8N_HOST
        value: samantha-voice-ai.onrender.com
      
      - key: WEBHOOK_URL
        value: https://samantha-voice-ai.onrender.com
      
      # Database - REPLACE WITH YOUR SUPABASE CONNECTION STRING
      - key: DB_TYPE
        value: postgresdb
      
      - key: DB_POSTGRESDB_DATABASE
        value: postgres
      
      - key: DB_POSTGRESDB_HOST
        sync: false # Set manually in Render dashboard
      
      - key: DB_POSTGRESDB_PORT
        value: 5432
      
      - key: DB_POSTGRESDB_USER
        value: postgres
      
      - key: DB_POSTGRESDB_PASSWORD
        sync: false # Set manually in Render dashboard - KEEP SECRET
      
      - key: DB_POSTGRESDB_SCHEMA
        value: public
      
      # Authentication
      - key: N8N_BASIC_AUTH_ACTIVE
        value: true
      
      - key: N8N_BASIC_AUTH_USER
        generateValue: true # Render will generate
      
      - key: N8N_BASIC_AUTH_PASSWORD
        generateValue: true # Render will generate
      
      # Encryption for credentials
      - key: N8N_ENCRYPTION_KEY
        generateValue: true # Render will generate - KEEP SECRET
      
      # Execution settings
      - key: EXECUTIONS_PROCESS
        value: main
      
      - key: EXECUTIONS_DATA_SAVE_ON_ERROR
        value: all
      
      - key: EXECUTIONS_DATA_SAVE_ON_SUCCESS
        value: all
      
      - key: EXECUTIONS_DATA_PRUNE
        value: true
      
      - key: EXECUTIONS_DATA_MAX_AGE
        value: 168 # 1 week
      
      # Queue mode for scaling (optional, can add later)
      - key: QUEUE_BULL_REDIS_HOST
        sync: false # Add Redis later for scaling
      
      # Timezone
      - key: GENERIC_TIMEZONE
        value: America/New_York # Change to your timezone
      
      # External API Keys - YOU'LL ADD THESE MANUALLY
      - key: ANTHROPIC_API_KEY
        sync: false # Add in Render dashboard
      
      - key: OPENAI_API_KEY
        sync: false # Add in Render dashboard
      
      - key: ELEVENLABS_API_KEY
        sync: false # Add in Render dashboard
      
      - key: STRIPE_SECRET_KEY
        sync: false # Add in Render dashboard
      
      - key: STRIPE_WEBHOOK_SECRET
        sync: false # Add in Render dashboard
